using System.ComponentModel;
using System.Text.Json;
using System.Windows;

namespace PhaethonsNomikon;

public class AgentCellBase : MyUserControl
{
    public static readonly DependencyProperty RealAgentProperty = DependencyProperty.Register(nameof(RealAgent), typeof(AgentData), typeof(AgentCellBase), new PropertyMetadata(OnRealAgentPropertyChanged));

    private static readonly AgentData DummyAgentData;
    public AgentData Agent { get; private set; } = DummyAgentData;

    protected virtual void OnAgentChanged() {}
    private static void OnRealAgentPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        if (d is AgentCellBase cell)
        {
            cell.Agent = (e.NewValue as AgentData) ?? DummyAgentData;
            cell.OnAgentChanged();
        }
    }


    public AgentData? RealAgent
    {
        get => (AgentData)GetValue(RealAgentProperty);
        set => SetValue(RealAgentProperty, value);
    }
    
    static AgentCellBase()
    {
        const string dummyAgentJson = """{"id":1311,"level":60,"name_mi18n":"Astra Yao","full_name_mi18n":"Astra Yao","element_type":205,"camp_name_mi18n":"Stars of Lyra","avatar_profession":4,"rarity":"S","group_icon_path":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/f1d8f71a0b44d0da71e1841b73b6bb04.png","hollow_icon_path":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/aae969365d07c943288e20ef4d09162d.png","equip":[{"id":32841,"level":15,"name":"Astral Voice [1]","icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/43b01b49b6242b7bf5b6ae8d79ce6290.png","rarity":"S","properties":[{"property_name":"CRIT DMG","property_id":21103,"base":"14.4%","level":3,"valid":false,"system_id":211,"add":2},{"property_name":"ATK","property_id":12103,"base":"19","level":1,"valid":false,"system_id":121,"add":0},{"property_name":"ATK","property_id":12102,"base":"6%","level":2,"valid":true,"system_id":121,"add":1},{"property_name":"PEN","property_id":23203,"base":"18","level":2,"valid":false,"system_id":232,"add":1}],"main_properties":[{"property_name":"HP","property_id":11103,"base":"2200","level":1,"valid":false,"system_id":111,"add":0}],"equip_suit":{"suit_id":32800,"name":"Astral Voice","own":4,"desc1":"ATK +10%","desc2":"Whenever any squad member enters the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, all squad members gain 1 stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e, up to a maximum of 3 stacks, and lasting 15s. Repeated triggers reset the duration. Each stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e increases the DMG dealt by the character entering the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e by 8%. Only one instance of this effect can exist in the same squad."},"equipment_type":1,"invalid_property_cnt":3,"all_hit":false},{"id":31642,"level":15,"name":"Swing Jazz [2]","icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/14991967219d38654185d0ce4060f9e0.png","rarity":"S","properties":[{"property_name":"CRIT DMG","property_id":21103,"base":"9.6%","level":2,"valid":false,"system_id":211,"add":1},{"property_name":"DEF","property_id":13103,"base":"30","level":2,"valid":false,"system_id":131,"add":1},{"property_name":"Anomaly Proficiency","property_id":31203,"base":"18","level":2,"valid":false,"system_id":312,"add":1},{"property_name":"HP","property_id":11102,"base":"6%","level":2,"valid":false,"system_id":111,"add":1}],"main_properties":[{"property_name":"ATK","property_id":12103,"base":"316","level":1,"valid":false,"system_id":121,"add":0}],"equip_suit":{"suit_id":31600,"name":"Swing Jazz","own":2,"desc1":"Energy Regen +20%","desc2":"Launching a \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e or \u003ccolor=#FFFFFF\u003eUltimate\u003c/color\u003e increases all squad members' DMG by 15% for 12s. Passive effects of the same name do not stack."},"equipment_type":2,"invalid_property_cnt":4,"all_hit":false},{"id":31643,"level":15,"name":"Swing Jazz [3]","icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/14991967219d38654185d0ce4060f9e0.png","rarity":"S","properties":[{"property_name":"DEF","property_id":13102,"base":"4.8%","level":1,"valid":false,"system_id":131,"add":0},{"property_name":"ATK","property_id":12102,"base":"12%","level":4,"valid":true,"system_id":121,"add":3},{"property_name":"ATK","property_id":12103,"base":"38","level":2,"valid":false,"system_id":121,"add":1},{"property_name":"HP","property_id":11102,"base":"6%","level":2,"valid":false,"system_id":111,"add":1}],"main_properties":[{"property_name":"DEF","property_id":13103,"base":"184","level":1,"valid":false,"system_id":131,"add":0}],"equip_suit":{"suit_id":31600,"name":"Swing Jazz","own":2,"desc1":"Energy Regen +20%","desc2":"Launching a \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e or \u003ccolor=#FFFFFF\u003eUltimate\u003c/color\u003e increases all squad members' DMG by 15% for 12s. Passive effects of the same name do not stack."},"equipment_type":3,"invalid_property_cnt":2,"all_hit":false},{"id":32844,"level":15,"name":"Astral Voice [4]","icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/43b01b49b6242b7bf5b6ae8d79ce6290.png","rarity":"S","properties":[{"property_name":"CRIT DMG","property_id":21103,"base":"19.2%","level":4,"valid":false,"system_id":211,"add":3},{"property_name":"DEF","property_id":13102,"base":"9.6%","level":2,"valid":false,"system_id":131,"add":1},{"property_name":"DEF","property_id":13103,"base":"30","level":2,"valid":false,"system_id":131,"add":1},{"property_name":"HP","property_id":11103,"base":"112","level":1,"valid":false,"system_id":111,"add":0}],"main_properties":[{"property_name":"ATK","property_id":12102,"base":"30%","level":1,"valid":false,"system_id":121,"add":0}],"equip_suit":{"suit_id":32800,"name":"Astral Voice","own":4,"desc1":"ATK +10%","desc2":"Whenever any squad member enters the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, all squad members gain 1 stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e, up to a maximum of 3 stacks, and lasting 15s. Repeated triggers reset the duration. Each stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e increases the DMG dealt by the character entering the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e by 8%. Only one instance of this effect can exist in the same squad."},"equipment_type":4,"invalid_property_cnt":5,"all_hit":false},{"id":32845,"level":15,"name":"Astral Voice [5]","icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/43b01b49b6242b7bf5b6ae8d79ce6290.png","rarity":"S","properties":[{"property_name":"HP","property_id":11103,"base":"224","level":2,"valid":false,"system_id":111,"add":1},{"property_name":"DEF","property_id":13103,"base":"45","level":3,"valid":false,"system_id":131,"add":2},{"property_name":"CRIT Rate","property_id":20103,"base":"2.4%","level":1,"valid":false,"system_id":201,"add":0},{"property_name":"DEF","property_id":13102,"base":"9.6%","level":2,"valid":false,"system_id":131,"add":1}],"main_properties":[{"property_name":"ATK","property_id":12102,"base":"30%","level":1,"valid":false,"system_id":121,"add":0}],"equip_suit":{"suit_id":32800,"name":"Astral Voice","own":4,"desc1":"ATK +10%","desc2":"Whenever any squad member enters the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, all squad members gain 1 stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e, up to a maximum of 3 stacks, and lasting 15s. Repeated triggers reset the duration. Each stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e increases the DMG dealt by the character entering the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e by 8%. Only one instance of this effect can exist in the same squad."},"equipment_type":5,"invalid_property_cnt":4,"all_hit":false},{"id":32846,"level":15,"name":"Astral Voice [6]","icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/43b01b49b6242b7bf5b6ae8d79ce6290.png","rarity":"S","properties":[{"property_name":"DEF","property_id":13103,"base":"30","level":2,"valid":false,"system_id":131,"add":1},{"property_name":"HP","property_id":11103,"base":"224","level":2,"valid":false,"system_id":111,"add":1},{"property_name":"HP","property_id":11102,"base":"6%","level":2,"valid":false,"system_id":111,"add":1},{"property_name":"ATK","property_id":12102,"base":"6%","level":2,"valid":true,"system_id":121,"add":1}],"main_properties":[{"property_name":"Energy Regen","property_id":30502,"base":"60%","level":1,"valid":false,"system_id":305,"add":0}],"equip_suit":{"suit_id":32800,"name":"Astral Voice","own":4,"desc1":"ATK +10%","desc2":"Whenever any squad member enters the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, all squad members gain 1 stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e, up to a maximum of 3 stacks, and lasting 15s. Repeated triggers reset the duration. Each stack of \u003ccolor=#FFFFFF\u003eAstral\u003c/color\u003e increases the DMG dealt by the character entering the field using a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e by 8%. Only one instance of this effect can exist in the same squad."},"equipment_type":6,"invalid_property_cnt":3,"all_hit":false}],"weapon":{"id":14131,"level":60,"name":"Elegant Vanity","star":1,"icon":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/53715d2c90c12c540cacb7835980743a.png","rarity":"S","properties":[{"property_name":"ATK","property_id":12102,"base":"30%","level":0,"valid":false,"system_id":0,"add":0}],"main_properties":[{"property_name":"Base ATK","property_id":12101,"base":"713","level":0,"valid":false,"system_id":0,"add":0}],"talent_title":"Untold Beauty","talent_content":"When any squad member enters the field through a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDefensive Assist\u003c/color\u003e, or \u003ccolor=#FFFFFF\u003eEvasive Assist\u003c/color\u003e, the equipper gains \u003ccolor=#2BAD00\u003e5\u003c/color\u003e Energy. This effect can trigger once every 5s. When the equipper consumes 25 or more Energy, the DMG dealt by all squad members increases by \u003ccolor=#2BAD00\u003e10%\u003c/color\u003e, stacking up to 2 times, and lasting 20s. Repeated triggers reset the duration. Only one instance of this effect can exist in the same squad.","profession":4},"properties":[{"property_name":"HP","property_id":1,"base":"8609","add":"4310","final":"12919"},{"property_name":"ATK","property_id":2,"base":"1428","add":"2143","final":"3571"},{"property_name":"DEF","property_id":3,"base":"600","add":"463","final":"1063"},{"property_name":"Impact","property_id":4,"base":"","add":"","final":"83"},{"property_name":"CRIT Rate","property_id":5,"base":"","add":"","final":"7.4%"},{"property_name":"CRIT DMG","property_id":6,"base":"","add":"","final":"93.2%"},{"property_name":"Anomaly Mastery","property_id":7,"base":"","add":"","final":"93"},{"property_name":"Anomaly Proficiency","property_id":8,"base":"","add":"","final":"110"},{"property_name":"PEN Ratio","property_id":9,"base":"","add":"","final":"0.0%"},{"property_name":"Energy Regen","property_id":11,"base":"1.56","add":"1.24","final":"2.80"},{"property_name":"PEN","property_id":232,"base":"","add":"","final":"18"},{"property_name":"Ether DMG Bonus","property_id":319,"base":"","add":"","final":"0.0%"}],"skills":[{"level":6,"skill_type":0,"items":[{"title":"Basic Attack: \"Capriccio\"","text":"Press \u003cIconMap:Icon_Normal\u003e to activate:\\nPerform up to three attacks forward, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nDuring the 3rd hit, hold \u003cIconMap:Icon_Normal\u003e to charge, drawing enemies in and expanding the attack range for a stronger attack.\\nAfter using other skills, hold \u003cIconMap:Icon_Normal\u003e to initiate the 3rd hit directly."},{"title":"Basic Attack: Interlude","text":"While in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, press \u003cIconMap:Icon_Normal\u003e to activate:\\nRelease \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e forward to attack, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nA \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e will be triggered when this skill hits an enemy."},{"title":"Basic Attack: Chorus","text":"While in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, press \u003cIconMap:Icon_Normal\u003e during a \u003ccolor=#FFFFFF\u003ePerfect Dodge\u003c/color\u003e to activate:\\nLaunch multiple \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e attacks at enemies in front, dealing massive \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nA \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e will be triggered when this skill hits an enemy.\\nCharacter is invulnerable while using this skill."},{"title":"Basic Attack: Finale","text":"While in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, hold \u003cIconMap:Icon_Normal\u003e to activate:\\nRelease \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e forward to attack, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e and exit the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state.\\nUpon activation of the skill, it grants Astra Yao the buff from \u003ccolor=#FFFFFF\u003eCore Passive: \"Graceful Andante\"\u003c/color\u003e.\\nWith enough Energy, consumes Energy to follow up with 1 \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e and 3 \u003ccolor=#FFFFFF\u003eTone Clusters\u003c/color\u003e. This \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e attack released is considered an \u003ccolor=#FFFFFF\u003eEX Special Attack\u003c/color\u003e."}]},{"level":12,"skill_type":1,"items":[{"title":"Special Attack: \"Windchimes \u0026 Oaths\"","text":"Press \u003cIconMap:Icon_Special\u003e to activate:\\nQuickly move away, then release \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e, and enter the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state.\\nDuring activation, dragging the {LAYOUT_CONSOLECONTROLLER#stick}{LAYOUT_FALLBACK#joystick} enables movement in the direction held.\\nHold \u003cIconMap:Icon_Special\u003e to charge during activation, drawing enemies in, and follow up with 1 to 4 \u003ccolor=#FFFFFF\u003eTremolos\u003c/color\u003e depending on the charge duration.\\nA \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e will be triggered when this skill hits an enemy.\\nCharacter is invulnerable when quickly moving away."},{"title":"Idyllic Cadenza","text":"After entering the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, Astra Yao increases all squad members' DMG by \u003ccolor=#2BAD00\u003e20%\u003c/color\u003e and CRIT DMG by \u003ccolor=#2BAD00\u003e25%\u003c/color\u003e.\\nWhile in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, Astra Yao cannot move, but pressing \u003cIconMap:Icon_Normal\u003e will activate \u003ccolor=#FFFFFF\u003eBasic Attack: Interlude\u003c/color\u003e, and pressing \u003cIconMap:Icon_Evade\u003e will activate a dodge. After triggering a \u003ccolor=#FFFFFF\u003ePerfect Dodge\u003c/color\u003e, press \u003cIconMap:Icon_Normal\u003e to activate \u003ccolor=#FFFFFF\u003eBasic Attack: Chorus\u003c/color\u003e.\\nWhile in this state, Astra Yao's Anti-Interrupt Level is increased, and the DMG she takes is reduced by 40%. After switching to another character, Astra Yao will remain on the field and become Invulnerable. When switching back to her, she will automatically follow up with \u003ccolor=#FFFFFF\u003eSpecial Attack: \"Windchimes \u0026 Oaths\"\u003c/color\u003e.\\nDuring this state, hold \u003cIconMap:Icon_Normal\u003e to activate \u003ccolor=#FFFFFF\u003eBasic Attack: Finale\u003c/color\u003e, exiting the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, or hold \u003cIconMap:Icon_Evade\u003e to exit the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state directly."},{"title":"Chord","text":"For every 25 Energy, Astra Yao will have 1 \u003ccolor=#FFFFFF\u003eChord\u003c/color\u003e.\\nWhile in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, when Astra Yao has \u003ccolor=#FFFFFF\u003eChords\u003c/color\u003e, a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e can be triggered in the following situations:\\n· When the active character's attack hits an enemy, once per 3s.\\n· When the active character's heavy attack hits an enemy, once per 1s.\\nWhen other squad members switch in through a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDefensive Assist\u003c/color\u003e, or \u003ccolor=#FFFFFF\u003eEvasive Assist\u003c/color\u003e, Astra Yao will consume 25 Energy and release 1 \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e to attack. This \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e attack released is considered an \u003ccolor=#FFFFFF\u003eEX Special Attack\u003c/color\u003e.\\nAfter triggering a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, quickly press \u003cIconMap:Icon_Switch\u003e to switch characters and trigger a \u003ccolor=#FFFFFF\u003ePrecise Assist\u003c/color\u003e, causing Astra Yao to follow up with 3 \u003ccolor=#FFFFFF\u003eTone Clusters\u003c/color\u003e to attack. When other squad members switch in through a \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDefensive Assist\u003c/color\u003e, or \u003ccolor=#FFFFFF\u003eEvasive Assist\u003c/color\u003e, it will automatically trigger a \u003ccolor=#FFFFFF\u003ePrecise Assist\u003c/color\u003e."}]},{"level":3,"skill_type":2,"items":[{"title":"Dodge: \"Mini Waltz\"","text":"Press \u003cIconMap:Icon_Evade\u003e to activate:\\nA quick dash dodge.\\nCharacter is invulnerable while using this skill."},{"title":"Dash Attack: \"Lunar Eclipse Melody\"","text":"Press \u003cIconMap:Icon_Normal\u003e during a dodge to activate:\\nAttack ahead, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nWhen triggered, dragging the {LAYOUT_CONSOLECONTROLLER#stick}{LAYOUT_FALLBACK#joystick} allows movement in the corresponding direction."},{"title":"Dodge Counter: \"Umbrella Waltz\"","text":"Press \u003cIconMap:Icon_Normal\u003e during a \u003ccolor=#FFFFFF\u003ePerfect Dodge\u003c/color\u003e to activate:\\nAttack enemies in front, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nCharacter is invulnerable while using this skill."}]},{"level":9,"skill_type":3,"items":[{"title":"Chain Attack: \"Tipsy Concerto\"","text":"When a \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e is triggered, select the character to activate:\\nUse song to channel energy into a blast, dealing massive \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nCharacter is invulnerable while using this skill.\\nA \u003ccolor=#ffffff\u003eQuick Assist\u003c/color\u003e is triggered when this skill hits an enemy.\\nAfter the skill, Astra Yao enters the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state."},{"title":"Ultimate: \"Fantasian Sonata\"","text":"When Decibel Rating is at \u003ccolor=#FFFFFF\u003eMaximum\u003c/color\u003e, press \u003cIconMap:Icon_UltimateReady\u003e to activate:\\nUse song to channel energy into a blast, dealing massive \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e, and restoring \u003ccolor=#2BAD00\u003e2200\u003c/color\u003e HP to all squad members.\\nCharacter is invulnerable while using this skill.\\nA \u003ccolor=#ffffff\u003eQuick Assist\u003c/color\u003e is triggered when this skill hits an enemy.\\nAfter the skill, Astra Yao enters the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state.\\nAfter the skill, the next two \u003ccolor=#FFFFFF\u003eQuick Assists\u003c/color\u003e will be replaced by \u003ccolor=#FFFFFF\u003eChain Attacks\u003c/color\u003e.\\nBefore all replacement chances are used up, a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e is triggered whenever any squad member hits an enemy with a \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e or \u003ccolor=#FFFFFF\u003eUltimate\u003c/color\u003e."}]},{"level":7,"skill_type":5,"items":[{"title":"Core Passive: \"Graceful Andante\"","text":"During the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, when other squad members switch in through a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDefensive Assist\u003c/color\u003e, or \u003ccolor=#FFFFFF\u003eEvasive Assist\u003c/color\u003e, and when Astra Yao expends Energy to release \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e to attack, both Astra Yao and the incoming character's ATK are increased. The increase is equal to \u003ccolor=#2BAD00\u003e35%\u003c/color\u003e of Astra Yao's initial ATK, up to a maximum of 1200. The effect lasts for 20s and can be extended up to 30s with repeated triggers."},{"title":"Additional Ability: \"Moonlit Frenzy\"","text":"When another character in your squad is an \u003ccolor=#FFFFFF\u003eAttack\u003c/color\u003e or \u003ccolor=#FFFFFF\u003eAnomaly\u003c/color\u003e character:\\nWhen Energy is consumed to trigger a \u003ccolor=#FFFFFF\u003ePrecise Assist\u003c/color\u003e or \u003ccolor=#FFFFFF\u003eBasic Attack: Finale\u003c/color\u003e, Astra Yao will additionally follow up with 1 \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e and 3 \u003ccolor=#FFFFFF\u003eTone Clusters\u003c/color\u003e."}]},{"level":3,"skill_type":6,"items":[{"title":"Quick Assist: \"One Luminous Sky\"","text":"When the active character is launched, press \u003cIconMap:Icon_Switch\u003e to activate:\\nAttack enemies in front, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nCharacter is invulnerable while using this skill."},{"title":"Evasive Assist: \"Two Hearts\"","text":"When the on-field character is about to be attacked, press \u003cIconMap:Icon_Switch\u003e to activate:\\nDodges the enemy's attack and activates \u003ccolor=#FFFFFF\u003eVital View\u003c/color\u003e.\\nCharacter is invulnerable while using this skill."},{"title":"Assist Follow-Up: \"Three Lifetimes of Fate\"","text":"Press \u003cIconMap:Icon_Normal\u003e after an \u003ccolor=#FFFFFF\u003eEvasive Assist\u003c/color\u003e to activate:\\nRelease an energy beam forward, dealing \u003ccolor=#FE437E\u003eEther DMG\u003c/color\u003e.\\nCharacter is invulnerable while using this skill."}]}],"rank":0,"ranks":[{"id":1,"name":"12-Tone Equal Temperament","desc":"When Astra Yao's attack hits an enemy, the target's All-Attribute RES is reduced by 6%, stacking up to 3 times and lasting 30s. Repeated triggers refresh the duration.\\nUpon entering the battlefield, Astra Yao immediately gains 1000 Decibels.\\nWhen activating her \u003ccolor=#FFFFFF\u003eUltimate\u003c/color\u003e, all squad members gain 1 stack of \u003ccolor=#FFFFFF\u003eSong of Protection\u003c/color\u003e for 60s. When attacked by an enemy, consume \u003ccolor=#FFFFFF\u003eSong of Protection\u003c/color\u003e, granting Invulnerability for 1s.","pos":1,"is_unlocked":false},{"id":2,"name":"Art of Greed","desc":"The ATK buff from \u003ccolor=#FFFFFF\u003eCore Passive: \"Graceful Andante\"\u003c/color\u003e is further increased by 19%, with an increased maximum of 400.\\nWhile in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, when other squad members switch in through a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDefensive Assist\u003c/color\u003e, or \u003ccolor=#FFFFFF\u003eEvasive Assist\u003c/color\u003e, Astra Yao will additionally follow up with 1 \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e and 3 \u003ccolor=#FFFFFF\u003eTone Clusters\u003c/color\u003e to attack. This effect can trigger once every 3s.","pos":2,"is_unlocked":false},{"id":3,"name":"Interwoven Staff Notation","desc":"\u003ccolor=#FFFFFF\u003eBasic Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDodge\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eAssist\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eSpecial Attack\u003c/color\u003e, and \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e Lv. +2","pos":3,"is_unlocked":false},{"id":4,"name":"\"Hair Upon Your Nape\"","desc":"After activating a \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e or \u003ccolor=#FFFFFF\u003eUltimate\u003c/color\u003e, within 15s, Astra Yao can trigger a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e even if she does not have \u003ccolor=#FFFFFF\u003eChords\u003c/color\u003e. When the attack hits an enemy, the interval for triggering a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e is reduced to 1s.\\nWhile in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, when other squad members enter the field via a \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e, they will receive different buffs based on their specialty, and this effect can be triggered once every 3s for the entire squad:\\n\u003ccolor=#FFFFFF\u003eAttack\u003c/color\u003e: The next \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e heavy attack on an enemy will deal extra DMG equal to 300% of Astra Yao's ATK;\\n\u003ccolor=#FFFFFF\u003eAnomaly\u003c/color\u003e: The next \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e will have 50% increased Anomaly Buildup;\\n\u003ccolor=#FFFFFF\u003eStun\u003c/color\u003e: The next \u003ccolor=#FFFFFF\u003eQuick Assist\u003c/color\u003e will inflict 50% increased Daze.","pos":4,"is_unlocked":false},{"id":5,"name":"Proxy and Silk String","desc":"\u003ccolor=#FFFFFF\u003eBasic Attack\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eDodge\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eAssist\u003c/color\u003e, \u003ccolor=#FFFFFF\u003eSpecial Attack\u003c/color\u003e, and \u003ccolor=#FFFFFF\u003eChain Attack\u003c/color\u003e Lv. +2","pos":5,"is_unlocked":false},{"id":6,"name":"We Are the World","desc":"While in the \u003ccolor=#FFFFFF\u003eIdyllic Cadenza\u003c/color\u003e state, the DMG multiplier for \u003ccolor=#FFFFFF\u003eTremolo\u003c/color\u003e and \u003ccolor=#FFFFFF\u003eTone Clusters\u003c/color\u003e released or followed up with will increase to 200% of the original, and CRIT Rate is increased by 80%.\\nWhen triggering a \u003ccolor=#FFFFFF\u003ePrecise Assist\u003c/color\u003e, Astra Yao will automatically follow up with the charged 3rd-hit of \u003ccolor=#FFFFFF\u003eBasic Attack: \"Capriccio\"\u003c/color\u003e, with a 80% increased CRIT Rate. This effect can trigger once every 10s.","pos":6,"is_unlocked":false}],"role_vertical_painting_url":"https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_1311.png","equip_plan_info":{"type":1,"game_default":{"property_list":[{"id":2,"name":"ATK","full_name":"ATK","system_id":2,"is_select":false},{"id":11,"name":"Energy Regen","full_name":"Energy Regen","system_id":11,"is_select":false}]},"cultivate_info":{"name":"Astra","plan_id":"8973","is_delete":false,"old_plan":false},"custom_info":{"property_list":[{"id":11103,"name":"HP","full_name":"HP","system_id":111,"is_select":false},{"id":11102,"name":"HP","full_name":"Percent HP","system_id":111,"is_select":false},{"id":12103,"name":"ATK","full_name":"ATK","system_id":121,"is_select":false},{"id":12102,"name":"ATK","full_name":"Percent ATK","system_id":121,"is_select":false},{"id":13103,"name":"DEF","full_name":"DEF","system_id":131,"is_select":false},{"id":13102,"name":"DEF","full_name":"Percent DEF","system_id":131,"is_select":false},{"id":20103,"name":"CRIT Rate","full_name":"CRIT Rate","system_id":201,"is_select":false},{"id":21103,"name":"CRIT DMG","full_name":"CRIT DMG","system_id":211,"is_select":false},{"id":31203,"name":"Anomaly Proficiency","full_name":"Anomaly Proficiency","system_id":312,"is_select":false},{"id":23203,"name":"PEN","full_name":"PEN","system_id":232,"is_select":false}]},"valid_property_cnt":8,"plan_only_special_property":false,"equip_rating":"ER_A","plan_effective_property_list":[{"id":12102,"name":"ATK","full_name":"Percent ATK","system_id":121,"is_select":false}],"equip_rating_score":66.67},"us_full_name":"Astra Yao","vertical_painting_color":"#D12D4E","sub_element_type":0,"skin_list":[{"skin_id":3113111,"skin_name":"Astra Yao: Chandelier","skin_vertical_painting_url":"https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_1311_3113111.png","skin_square_url":"https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_square_avatar/role_square_avatar_1311_3113111.png","skin_hollow_icon_path":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/8da8d11f515478c3f6b91e1e53739004.png","skin_vertical_painting_color":"#D12D4E","unlocked":false,"rarity":"S","is_original":false},{"skin_id":3113110,"skin_name":"Astra Yao: Scarlet Rock","skin_vertical_painting_url":"https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_vertical_painting/role_vertical_painting_1311.png","skin_square_url":"https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_square_avatar/role_square_avatar_1311.png","skin_hollow_icon_path":"https://act-webstatic.hoyoverse.com/darkmatter/nap/prod_gf_cn/item_icon_u3294b/aae969365d07c943288e20ef4d09162d.png","skin_vertical_painting_color":"#D12D4E","unlocked":true,"rarity":"S","is_original":true}],"role_square_url":"https://act-webstatic.hoyoverse.com/game_record/zzzv2/role_square_avatar/role_square_avatar_1311.png"}""";
        var doc = JsonDocument.Parse(dummyAgentJson);
        var root = doc.RootElement;
        DummyAgentData = AgentData.FromJson(root, null)!;
    }
}